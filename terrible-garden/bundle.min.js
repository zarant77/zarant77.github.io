!function e(t,i,n){function a(r,s){if(!i[r]){if(!t[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[r]={exports:{}};t[r][0].call(u.exports,function(e){var i=t[r][1][e];return a(i||e)},u,u.exports,e,t,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}({1:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){var i=[],n=!0,a=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("../prefabs/item"),c=n(s),l=e("../prefabs/selection"),u=n(l),h=e("./hint"),f=n(h),g=e("./tutorial"),m=n(g),d=function(){function e(t){a(this,e),this.game=t,this.items=[],this.deadItems=[],this.isGameStarted=!1,this.hint=new f.default(this),this.tutorial=new m.default(this),this.spawnBoard()}return r(e,[{key:"spawnBoard",value:function(){var e=this;this.selection=new u.default(this.game),this.items=[];for(var t=[],i=0;i<this.game.cfg.cols;i++)for(var n=0;n<this.game.cfg.rows;n++){var a=this.game.cfg.map[i+"-"+n]||["bg_ground",!0];if(t.push([a[0],i,n]),a[1]){var o=new c.default(this.game,this.selection);o.setPos(i,n),this.items.push(o)}}t.forEach(function(t){var i=e.game.add.tileSprite(e.game.cfg.x(t[1]),e.game.cfg.y(t[2]),256,256,t[0]);i.scale.x=e.game.cfg.ratio,i.scale.y=e.game.cfg.ratio}),this.items.forEach(function(t){e.game.add.existing(t)}),this.game.add.existing(this.selection),this.selection.onMove(function(t,i,n,a){return e.onMove(t,i,n,a)}),this.checkBoard(),this.game.time.events.add(.2*Phaser.Timer.SECOND,function(){e.isGameStarted=!0,e.tutorial.start(e.hint.show())},this)}},{key:"isCellAvailable",value:function(e,t){return(this.game.cfg.map[e+"-"+t]||["bg_ground",!0])[1]}},{key:"checkBoard",value:function(){var e=this,t=!1;return this.items.forEach(function(i){t=e.checMatches(i)||t}),t&&this.killItems(),t}},{key:"onMove",value:function(e,t,i,n){var a=this;if(this.hint.reset(),this.checkMove(e,t,i,n)){var o=this.findItem(e,t),r=this.findItem(i,n);this.swapItems(o,r,2).then(function(){var e=a.checMatches(o);e=a.checMatches(r)||e,e?a.killItems():(a.swapItems(o,r,2),a.hint.reset())})}else setTimeout(function(){return a.selection.set(i,n)}),this.hint.reset()}},{key:"checkMove",value:function(e,t,i,n){return(1===Math.abs(e-i)&&t===n||1===Math.abs(t-n)&&e===i)&&i>=0&&n>=0&&i<this.game.cfg.cols&&n<this.game.cfg.rows}},{key:"swapItems",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=e.col,o=e.row,r=e.animateMove(t.col,t.row,n);return t.animateMove(e.col,e.row,n),e.setPos(t.col,t.row),t.setPos(a,o),new Promise(function(e){return i.game.time.events.add(r+100,function(){return e()})})}},{key:"findItem",value:function(e,t){var i=c.default.calcId(e,t);return this.items.find(function(e){return e.id===i})||null}},{key:"checMatches",value:function(e){var t=!1,i=this.countSameValue(e,0,-1),n=this.countSameValue(e,0,1),a=this.countSameValue(e,-1,0),o=this.countSameValue(e,1,0),r=a+o+1;return i+n+1>=this.game.cfg.minMatch&&(this.killRange(e.col,e.row-i,e.col,e.row+n),t=!0),r>=this.game.cfg.minMatch&&(this.killRange(e.col-a,e.row,e.col+o,e.row),t=!0),t}},{key:"countSameValue",value:function(e,t,i){for(var n=e.col+t,a=e.row+i,o=0;n>=0&&a>=0&&n<this.game.cfg.cols&&a<this.game.cfg.rows&&this.findItem(n,a)&&e&&this.findItem(n,a).value===e.value;)o++,n+=t,a+=i;return o}},{key:"killRange",value:function(e,t,i,n){e=Phaser.Math.clamp(e,0,this.game.cfg.cols-1),t=Phaser.Math.clamp(t,0,this.game.cfg.rows-1),i=Phaser.Math.clamp(i,0,this.game.cfg.cols-1),n=Phaser.Math.clamp(n,0,this.game.cfg.rows-1);for(var a=e;a<=i;a++)for(var o=t;o<=n;o++)this.findItem(a,o).toDie=!0}},{key:"killItems",value:function(){var e=this;this.isGameStarted?(this.items.forEach(function(e){e.toDie&&e.animateExplode()}),this.game.time.events.add(300,function(){return e.removeKilledItems()})):this.removeKilledItems()}},{key:"removeKilledItems",value:function(){var e=this;this.items.forEach(function(t){t.toDie&&(e.isGameStarted&&(void 0===e.game.score[t.value]&&(e.game.score[t.value]=0),e.game.score[t.value]++,e.game.score.total++),t.kill(),t.setPos(-1,-1),e.deadItems.push(t))}),this.dropItems()}},{key:"dropItems",value:function(){for(var e=this,t=[],i=0,n=0,a=0;a<this.game.cfg.cols;a++){for(var r=0,s=this.game.cfg.rows-1;s>=0;s--)if(this.isCellAvailable(a,s)){var c=this.findItem(a,s);null===c?r++:r>0&&(c.dirty=!0,t.push([c,r]))}n=Math.max(r,n)}this.isGameStarted?(t.forEach(function(e){var t=o(e,2),n=t[0],a=t[1],r=n.animateMove(n.col,n.row+a,a);n.setPos(n.col,n.row+a),r>i&&(i=r)}),this.game.time.events.add(i+100,function(){return e.refillBoard()})):(t.forEach(function(e){var t=o(e,2),i=t[0],n=t[1];i.setPos(i.col,i.row+n)}),this.refillBoard())}},{key:"refillBoard",value:function(){for(var e=this,t=0,i=0;i<this.game.cfg.cols;i++){for(var n=0,a=this.game.cfg.rows-1;a>=0;a--)if(this.isCellAvailable(i,a)&&!this.findItem(i,a)){n++;var o=this.deadItems.shift();o.dirty=!0,o.spawn(),o.reset(this.game.cfg.x(i),-o.height),this.isGameStarted&&o.animateMove(i,a),o.setPos(i,a)}t=Math.max(t,n)}this.game.time.events.add(2*t*100,function(){return e.checkBoard()}),this.hint.reset(),this.onBoardRefilled()}},{key:"onBoardRefilled",value:function(){this.isGameStarted=!0,this.tutorial.stop()}}]),e}();i.default=d},{"../prefabs/item":6,"../prefabs/selection":7,"./hint":2,"./tutorial":4}],2:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.core=t,this.counter=0,this.hintFound=null,this.highlightedItems=[],this.hintTimer=this.core.game.time.events.loop(Phaser.Timer.SECOND,this.findHintAndAnimate,this)}return a(e,[{key:"show",value:function(){return this.counter=5,this.hintFound=this.getHint(),this.highlightedItems}},{key:"reset",value:function(){this.counter=0,this.hintFound=null,this.highlightedItems=[]}},{key:"findHintAndAnimate",value:function(){if(!(++this.counter<5)&&(null===this.hintFound&&(this.hintFound=this.getHint()),null!==this.hintFound)){var e=this.core.findItem(this.hintFound.fromCol,this.hintFound.fromRow);null!==e&&e.animateHint(this.hintFound.toCol,this.hintFound.toRow)}}},{key:"getHint",value:function(){for(var e=0;e<this.core.items.length;e++){var t=this.core.items[e].col,i=this.core.items[e].row,n=this.checkNeighbors([t,i],[-1,0],[1,0],[0,-1])||this.checkNeighbors([t,i],[-1,0],[1,0],[0,1])||this.checkNeighbors([t,i],[0,-1],[0,1],[-1,0])||this.checkNeighbors([t,i],[0,-1],[0,1],[1,0])||this.checkNeighbors([t,i],[-2,0],[-1,0],[1,0])||this.checkNeighbors([t,i],[2,0],[1,0],[-1,0])||this.checkNeighbors([t,i],[0,-2],[0,-1],[0,1])||this.checkNeighbors([t,i],[0,2],[0,1],[0,-1])||this.checkNeighbors([t,i],[0,-2],[0,-1],[-1,0])||this.checkNeighbors([t,i],[0,-2],[0,-1],[1,0])||this.checkNeighbors([t,i],[0,2],[0,1],[-1,0])||this.checkNeighbors([t,i],[0,2],[0,1],[1,0])||this.checkNeighbors([t,i],[-2,0],[-1,0],[0,-1])||this.checkNeighbors([t,i],[-2,0],[-1,0],[0,1])||this.checkNeighbors([t,i],[2,0],[1,0],[0,-1])||this.checkNeighbors([t,i],[2,0],[1,0],[0,1]);if(n)return{fromCol:n[0],fromRow:n[1],toCol:t,toRow:i}}return null}},{key:"checkNeighbors",value:function(e,t,i,n){return null!==this.getValue(e[0]+t[0],e[1]+t[1])&&this.getValue(e[0]+t[0],e[1]+t[1])===this.getValue(e[0]+i[0],e[1]+i[1])&&this.getValue(e[0]+t[0],e[1]+t[1])===this.getValue(e[0]+n[0],e[1]+n[1])?(this.highlightedItems=[e,[e[0]+t[0],e[1]+t[1]],[e[0]+i[0],e[1]+i[1]],[e[0]+n[0],e[1]+n[1]]],[e[0]+n[0],e[1]+n[1]]):null}},{key:"getValue",value:function(e,t){return(this.core.findItem(e,t)||{}).value||null}}]),e}();i.default=o},{}],3:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t){var i=this;n(this,e),this.game=t,this.left=this.game.cfg.boardRight-this.game.cfg.scoreboardCols*this.game.cfg.tileSize,this.top=this.game.cfg.boardTop,this.right=this.game.cfg.boardRight,this.unit=this.game.cfg.tileSize,this.itemRatio=this.game.cfg.ratio/1.5;for(var a=0;a<this.game.cfg.scoreboardCols;a++)for(var o=0;o<this.game.cfg.rows;o++){var r=a*this.game.cfg.tileSize+this.left,s=this.game.add.tileSprite(r,this.game.cfg.y(o),256,256,"bg_main");s.scale.x=Math.abs(this.game.cfg.ratio),s.scale.y=Math.abs(this.game.cfg.ratio)}var c={font:this.game.cfg.tileSize/2+"px Arial",fill:"#ffffff",align:"center"};this.texts={timer:this.game.add.text(this.left+(this.right-this.left)/2,this.game.cfg.tileSize/2+this.game.cfg.minPadding,"",c)},this.texts.timer.anchor.set(.5,.5);for(var l=0;l<this.game.cfg.maxItems;l++)this.addRow(l,l,"items",l);this.addRow(this.game.cfg.maxItems,"total","total",0),this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER).onDown.add(function(e){e.altKey&&i.fullscreen()},this)}return a(e,[{key:"addRow",value:function(e,t,i,n){var a=e*this.unit/1.5+this.unit,o={font:this.game.cfg.tileSize/2+"px Arial",fill:"#ffffff",align:"center"},r=this.game.add.tileSprite(this.left+this.unit/4,a,256,256,i);r.scale.x=this.itemRatio,r.scale.y=this.itemRatio,r.frame=n,this.texts[t]=this.game.add.text(this.left+1.2*this.unit,a+10,"0",o)}},{key:"fullscreen",value:function(){this.game.scale.isFullScreen?this.game.scale.stopFullScreen():this.game.scale.startFullScreen(!1)}},{key:"update",value:function(e){var t=parseInt(e/60),i=parseInt(e%60);this.texts.timer.setText((t<10?"0"+t:t)+":"+(i<10?"0"+i:i));for(var n=0;n<this.game.cfg.maxItems;n++)this.texts[n].setText(this.game.score[n]||0);this.texts.total.setText(this.game.score.total||0)}}]),e}();i.default=o},{}],4:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.core=t,this.tiles=[]}return a(e,[{key:"start",value:function(e){this.tiles=[];for(var t=0;t<this.core.game.cfg.cols;t++)for(var i=0;i<this.core.game.cfg.rows;i++){for(var n=!1,a=0;a<e.length;a++)if(t===e[a][0]&&i===e[a][1]){n=!0;break}if(!n){var o=this.core.game.add.tileSprite(this.core.game.cfg.x(t),this.core.game.cfg.y(i),10,10,"tutorial-mask");o.width=this.core.game.cfg.tileSize,o.height=this.core.game.cfg.tileSize,o.alpha=.5,o.inputEnabled=!0,this.tiles.push(o)}}}},{key:"stop",value:function(){this.tiles.forEach(function(e){e.kill()})}}]),e}();i.default=o},{}],5:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=e("./states/boot"),o=n(a),r=e("./states/game"),s=n(r),c=e("./states/preloader"),l=n(c),u=e("./states/gameover"),h=n(u),f=new Phaser.Game(window.innerWidth,window.innerHeight,Phaser.AUTO,"terrible-garden-game");f.state.add("boot",new o.default),f.state.add("preloader",new l.default),f.state.add("game",new s.default),f.state.add("gameover",new h.default),f.state.start("boot")},{"./states/boot":8,"./states/game":9,"./states/gameover":10,"./states/preloader":11}],6:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,-1e3,-1e3,"items"));o.selection=i,o.id=null,o.col=null,o.row=null,o.value=null,o.toDie=!1,o.game.physics.arcade.enableBody(o),o.sndExplode=o.game.add.audio("explode"),o.scale.x=o.game.cfg.ratio,o.scale.y=o.game.cfg.ratio;for(var r=0;r<o.game.cfg.maxItems;r++)o.animations.add("item"+r,[r],5,!0);return o.animations.add("explode",[12,13,14,15,16,17,18,19,20,21,22,23],50,!1),o.selection&&(o.inputEnabled=!0,o.events.onInputDown.add(function(e,t){return o.selection.select(t)},o),o.events.onInputUp.add(function(e,t){return o.selection.release(t)},o)),o.spawn(),o}return o(t,e),r(t,[{key:"setPos",value:function(e,i){this.col=e,this.row=i,this.left=this.game.cfg.x(e),this.top=this.game.cfg.y(i),this.id=t.calcId(e,i)}},{key:"spawn",value:function(){this.toDie=!1,this.value=parseInt(Math.random()*this.game.cfg.maxItems),this.animations.play("item"+this.value)}},{key:"animateExplode",value:function(){this.sndExplode.play(),this.animations.play("explode")}},{key:"animateMove",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.tween&&this.game.tweens.remove(this.tween),this.tween=this.game.add.tween(this).to({x:this.game.cfg.x(e),y:this.game.cfg.y(t)},100*i,Phaser.Easing.Linear.None,!0),this.tween.totalDuration}},{key:"animateHint",value:function(e,t){var i=this,n=this.game.cfg.tileSize/5,a=[0,0];return e>this.col&&(a=[1,0]),e<this.col&&(a=[-1,0]),t>this.row&&(a=[0,1]),t<this.row&&(a=[0,-1]),new Promise(function(e){i.animate(i.game.cfg.x(i.col)+a[0]*n,i.game.cfg.y(i.row)+a[1]*n,Phaser.Easing.Bounce.Out).then(function(){i.animate(i.game.cfg.x(i.col),i.game.cfg.y(i.row),Phaser.Easing.Bounce.In).then(function(){return e()})})})}},{key:"animate",value:function(e,t){var i=this;arguments.length>2&&void 0!==arguments[2]?arguments[2]:Phaser.Easing.Linear.None;return this.bringToTop(),new Promise(function(n){var a=i.game.add.tween(i);a.to({x:e,y:t},500,Phaser.Easing.Bounce.Out,!0),a.start(),a.onComplete.add(function(){return n()},i)})}}],[{key:"calcId",value:function(e,t){return e+1e3*t}}]),t}(Phaser.Sprite);i.default=s},{}],7:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=function(e){function t(e){n(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,0,0,"selection"));return i.visible=!1,i.currentCol=null,i.currentRow=null,i._moveCallback=function(){},i.Xpos=null,i.Ypos=null,i.dragSensitivity=5,i.scale.x=i.game.cfg.ratio,i.scale.y=i.game.cfg.ratio,i.animations.add("idle",null,5,!0),i.animations.play("idle"),i}return o(t,e),r(t,[{key:"set",value:function(e,t){this.visible=!0,this.left=this.game.cfg.x(e),this.top=this.game.cfg.y(t),this.currentCol=e,this.currentRow=t,this.game.add.audio("select").play()}},{key:"select",value:function(e){this.Xpos=e.clientX,this.Ypos=e.clientY}},{key:"release",value:function(e){var t=this.Xpos-e.clientX,i=this.Ypos-e.clientY;if(Math.abs(t)<this.dragSensitivity&&Math.abs(i)<this.dragSensitivity)this.doSelect(this.game.cfg.col(this.Xpos),this.game.cfg.row(this.Ypos));else{if(this.currentCol=this.game.cfg.col(this.Xpos),this.currentRow=this.game.cfg.row(this.Ypos),Math.abs(t)>Math.abs(i)){var n=this.currentCol+(t>0?-1:1);n>=0&&n<this.game.cfg.cols&&this._moveCallback(this.currentCol,this.currentRow,n,this.currentRow)}else{var a=this.currentRow+(i>0?-1:1);a>=0&&a<this.game.cfg.rows&&this._moveCallback(this.currentCol,this.currentRow,this.currentCol,a)}this.visible=!1,this.currentCol=null,this.currentRow=null}this.Xpos=e.clientX,this.Ypos=e.clientY}},{key:"doSelect",value:function(e,t){null===this.currentCol?this.set(e,t):this.currentCol===e&&this.currentRow===t||(this.game.add.audio("move"+parseInt(3*Math.random())).play(),this._moveCallback(this.currentCol,this.currentRow,e,t),this.visible=!1,this.currentCol=null,this.currentRow=null)}},{key:"onMove",value:function(e){this._moveCallback=e}}]),t}(Phaser.Sprite);i.default=s},{}],8:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),r(t,[{key:"preload",value:function(){this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.load.image("preloader","assets/preloader.gif"),this.load.json("config","assets/configs/game.json")}},{key:"create",value:function(){this.game.input.maxPointers=1,this.game.scale.pageAlignHorizontally=!0,this.game.device.desktop||(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.minWidth=480,this.game.scale.minHeight=260,this.game.scale.maxWidth=640,this.game.scale.maxHeight=480,this.game.scale.forceOrientation(!0),this.game.scale.setSize()),this.initGlobalVariables()}},{key:"onLoadComplete",value:function(){this.loadConfig(),this.game.state.start("preloader")}},{key:"loadConfig",value:function(){var e=this.game.cache.getJSON("config"),t=window.innerWidth/window.innerHeight,i=(window.innerWidth-2*e.minPadding)/(e.cols+3+.5),n=(window.innerHeight-2*e.minPadding)/e.rows,a=n/i;e.tileSize=t>a?n:i,e.boardWidth=(e.cols+3+.5)*e.tileSize,e.boardHeight=e.rows*e.tileSize,e.boardLeft=window.innerWidth/2-e.boardWidth/2,e.boardTop=window.innerHeight/2-e.boardHeight/2,e.boardRight=window.innerWidth/2+e.boardWidth/2,e.boardBottom=window.innerHeight/2+e.boardHeight/2,e.ratio=e.tileSize/256,e.scoreboardCols=3,e.scoreboardPadding=.5,e.x=function(t){return e.tileSize*t+e.boardLeft},e.y=function(t){return e.tileSize*t+e.boardTop},e.col=function(t){return parseInt((t-e.boardLeft)/e.tileSize)},e.row=function(t){return parseInt((t-e.boardTop)/e.tileSize)},this.game.cfg=e}},{key:"initGlobalVariables",value:function(){this.game.score={total:0}}}]),t}(Phaser.State);i.default=s},{}],9:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=e("../game/core"),l=n(c),u=e("../game/scoreboard"),h=n(u),f=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return r(t,e),s(t,[{key:"create",value:function(){this.background=this.game.add.tileSprite(0,0,256,256,"bg_grass"),this.background.height=this.game.world.height,this.background.width=this.game.world.width,this.endGameTimer=this.game.time.create(),this.endGameTimer.add(Phaser.Timer.SECOND*this.game.cfg.timeout,this.endGame,this),this.endGameTimer.start(),this.core=new l.default(this.game),this.scoreboard=new h.default(this.game)}},{key:"update",value:function(){this.scoreboard.update(this.endGameTimer.duration/1e3)}},{key:"endGame",value:function(){this.game.state.start("gameover")}}]),t}(Phaser.State);i.default=f},{"../game/core":1,"../game/scoreboard":3}],10:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),r(t,[{key:"create",value:function(){var e=this;this.background=this.game.add.sprite(0,0,"bg_main"),this.background.height=this.game.world.height,this.background.width=this.game.world.width,this.add.text(this.game.world.centerX,this.game.world.centerY,"Score = "+this.game.score.total,{font:"42px Arial",fill:"#ffffff",align:"center"}).anchor.set(.5),this.add.text(this.game.world.centerX,this.game.world.centerY+100,"Tap to continue",{font:"42px Arial",fill:"#ffffff",align:"center"}).anchor.set(.5),this.input.onDown.add(this.onInputDown,this),this.canContinueToNextState=!1,this.game.time.events.add(.5*Phaser.Timer.SECOND,function(){e.canContinueToNextState=!0},this),this.saveVarsToLocalStorage(),this.resetGlobalVariables()}},{key:"saveVarsToLocalStorage",value:function(){this.game.score>localStorage.maxScore&&(localStorage.maxScore=this.game.score.total)}},{key:"resetGlobalVariables",value:function(){this.game.score={total:0}}},{key:"onInputDown",value:function(){this.canContinueToNextState&&this.game.state.start("game")}}]),t}(Phaser.State);i.default=s},{}],11:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=function(e){function t(){n(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.asset=null,e.ready=!1,e}return o(t,e),r(t,[{key:"preload",value:function(){this.asset=this.add.sprite(.5*this.game.width-110,.5*this.game.height-10,"preloader"),this.load.setPreloadSprite(this.asset),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.loadResources()}},{key:"loadResources",value:function(){this.game.load.image("bg_main","assets/bg_main.png"),this.game.load.image("bg_grass","assets/bg_grass.png"),this.game.load.image("bg_ground","assets/bg_ground.png"),this.game.load.image("selection","assets/selection.png"),this.game.load.image("total","assets/total.png"),this.game.load.image("tutorial-mask","assets/tutorial-mask.png"),this.game.load.spritesheet("items",this.game.cfg.sprite,256,256),this.game.load.audio("explode","assets/sounds/explode.mp3"),this.game.load.audio("select","assets/sounds/select.mp3"),this.game.load.audio("move0","assets/sounds/move0.mp3"),this.game.load.audio("move1","assets/sounds/move1.mp3"),this.game.load.audio("move2","assets/sounds/move2.mp3"),this.game.load.audio("miss","assets/sounds/miss.mp3")}},{key:"onLoadComplete",value:function(){this.game.state.start("game")}}]),t}(Phaser.State);i.default=s},{}]},{},[5]);
